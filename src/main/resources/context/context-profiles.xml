<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xmlns="http://www.springframework.org/schema/beans"
       xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-4.1.xsd">

    <bean id="stat-filter" class="com.alibaba.druid.filter.stat.StatFilter">
        <property name="slowSqlMillis" value="10000"/>
        <property name="logSlowSql" value="true"/>
    </bean>

    <bean id="log-filter" class="com.alibaba.druid.filter.logging.Log4jFilter">
        <property name="statementExecutableSqlLogEnable" value="true"/>
        <property name="resultSetLogEnabled" value="false"/>
    </bean>

    <beans profile="development">
        <!--缺省PropertyPlaceholder定义-->
        <bean id="extPropertyPlaceholderConfigurer"
              class="com.rascal.core.context.ExtPropertyPlaceholderConfigurer">
            <property name="locations">
                <list>
                    <value>classpath*:/application.properties</value>
                </list>
            </property>
            <property name="ignoreResourceNotFound" value="true"/>
            <property name="systemPropertiesModeName" value="SYSTEM_PROPERTIES_MODE_OVERRIDE"/>
        </bean>

        <!-- JDBC连接池  https://github.com/alibaba/druid/wiki/%E5%B8%B8%E8%A7%81%E9%97%AE%E9%A2%98 -->
        <bean id="dataSourceApp" class="com.alibaba.druid.pool.DruidDataSource" init-method="init"
              destroy-method="close">
            <!--创建MySQL UTF-8编码数据库脚本：CREATE DATABASE knight DEFAULT CHARACTER SET utf8 COLLATE utf8_general_ci;-->
            <property name="url" value="${jdbc_url}"/>
            <property name="username" value="${jdbc_username}"/>
            <property name="password" value="${jdbc_password}"/>

            <!--由外部事务管理器处理提交-->
            <property name="defaultAutoCommit" value="false"/>
            <property name="testWhileIdle" value="false"/>

            <!--配置j监控统计拦截的filters, 去掉后监控界面sql无法统计-->
            <property name="proxyFilters">
                <list>
                    <ref bean="stat-filter"/>
                    <ref bean="log-filter"/>
                </list>
            </property>
        </bean>

        <!-- JDBC连接池  https://github.com/alibaba/druid/wiki/%E5%B8%B8%E8%A7%81%E9%97%AE%E9%A2%98 -->
        <bean id="dataSourceQuartz" class="com.alibaba.druid.pool.DruidDataSource" init-method="init"
              destroy-method="close">
            <!--创建MySQL UTF-8编码数据库脚本：CREATE DATABASE knight DEFAULT CHARACTER SET utf8 COLLATE utf8_general_ci;-->
            <property name="url" value="${jdbc_url}"/>
            <property name="username" value="${jdbc_username}"/>
            <property name="password" value="${jdbc_password}"/>
        </bean>

        <!--<import resource="classpath*:/service/spring*.xml"/>-->
    </beans>

    <!--<beans profile="production">
        &lt;!&ndash;缺省PropertyPlaceholder定义&ndash;&gt;
        <bean id="extPropertyPlaceholderConfigurer" class="com.knight.core.context.ExtPropertyPlaceholderConfigurer">
            <property name="locations">
                <list>
                    <value>classpath*:/application.properties</value>
                    &lt;!&ndash;<value>classpath*:/application.prd.properties</value>
                    <value>classpath*:/build.filter.properties</value>
                    <value>file:/data/config/s2jh4net.properties</value>&ndash;&gt;
                </list>
            </property>
            <property name="ignoreResourceNotFound" value="true"/>
            <property name="systemPropertiesModeName" value="SYSTEM_PROPERTIES_MODE_OVERRIDE"/>
        </bean>

        &lt;!&ndash; JDBC连接池  https://github.com/alibaba/druid/wiki/%E5%B8%B8%E8%A7%81%E9%97%AE%E9%A2%98 &ndash;&gt;
        <bean id="dataSourceApp" class="com.alibaba.druid.pool.DruidDataSource" init-method="init"
              destroy-method="close">
            &lt;!&ndash; 创建MySQL UTF-8编码数据库脚本：CREATE DATABASE s2jh DEFAULT CHARACTER SET utf8 COLLATE utf8_general_ci; &ndash;&gt;
            <property name="url" value="${jdbc_url}"/>
            <property name="username" value="${jdbc_username}"/>
            <property name="password" value="${jdbc_password}"/>

            &lt;!&ndash;由外部事务管理器处理提交&ndash;&gt;
            <property name="defaultAutoCommit" value="false"/>

            &lt;!&ndash;配置初始化大小、最小、最大&ndash;&gt;
            <property name="initialSize" value="10"/>
            <property name="minIdle" value="20"/>
            <property name="maxActive" value="30"/>

            &lt;!&ndash;配置获取链接等待超时时间&ndash;&gt;
            <property name="maxWait" value="60000"/>

            &lt;!&ndash;配置间隔多久才进行一次检测,检测需要关闭的空闲链接。单位是毫秒&ndash;&gt;
            <property name="timeBetweenEvictionRunsMillis" value="60000"/>

            &lt;!&ndash;配置一个链接在池中最小生存时间，单位是毫秒&ndash;&gt;
            <property name="minEvictableIdleTimeMillis" value="300000"/>

            <property name="validationQuery" value="SELECT 'x'"/>
            <property name="testWhileIdle" value="true"/>
            <property name="testOnBorrow" value="false"/>
            <property name="testOnReturn" value="false"/>

            &lt;!&ndash;打开PSCache, 并且指定每个链接上PSCache的大小&ndash;&gt;
            <property name="poolPreparedStatements" value="false"/>
            <property name="maxPoolPreparedStatementPerConnectionSize" value="20"/>

            &lt;!&ndash;配置监控统计拦截的filters, 去掉监控界面sql无法统计&ndash;&gt;
            <property name="proxyFilters">
                <list>
                    <ref bean="stat-filter"/>
                </list>
            </property>
        </bean>

        &lt;!&ndash; JDBC连接池  https://github.com/alibaba/druid/wiki/%E5%B8%B8%E8%A7%81%E9%97%AE%E9%A2%98 &ndash;&gt;
        <bean id="dataSourceAud" class="com.alibaba.druid.pool.DruidDataSource" init-method="init"
              destroy-method="close">
            &lt;!&ndash; 创建MySQL UTF-8编码数据库脚本：CREATE DATABASE s2jh DEFAULT CHARACTER SET utf8 COLLATE utf8_general_ci; &ndash;&gt;
            <property name="url" value="${jdbc_url}"/>
            <property name="username" value="${jdbc_username}"/>
            <property name="password" value="${jdbc_password}"/>

            &lt;!&ndash;由外部事务管理器处理提交&ndash;&gt;
            <property name="defaultAutoCommit" value="false"/>

            &lt;!&ndash;配置初始化大小、最小、最大&ndash;&gt;
            <property name="initialSize" value="5"/>
            <property name="minIdle" value="10"/>
            <property name="maxActive" value="20"/>

            &lt;!&ndash;配置获取链接等待超时时间&ndash;&gt;
            <property name="maxWait" value="60000"/>

            &lt;!&ndash;配置间隔多久才进行一次检测,检测需要关闭的空闲链接。单位是毫秒&ndash;&gt;
            <property name="timeBetweenEvictionRunsMillis" value="60000"/>

            &lt;!&ndash;配置一个链接在池中最小生存时间，单位是毫秒&ndash;&gt;
            <property name="minEvictableIdleTimeMillis" value="300000"/>

            <property name="validationQuery" value="SELECT 'x'"/>
            <property name="testWhileIdle" value="true"/>
            <property name="testOnBorrow" value="false"/>
            <property name="testOnReturn" value="false"/>

            &lt;!&ndash;打开PSCache, 并且指定每个链接上PSCache的大小&ndash;&gt;
            <property name="poolPreparedStatements" value="false"/>
            <property name="maxPoolPreparedStatementPerConnectionSize" value="20"/>

            &lt;!&ndash;配置监控统计拦截的filters, 去掉监控界面sql无法统计&ndash;&gt;
            <property name="proxyFilters">
                <list>
                    <ref bean="stat-filter"/>
                    <ref bean="log-filter"/>
                </list>
            </property>
        </bean>

        &lt;!&ndash; JDBC连接池  https://github.com/alibaba/druid/wiki/%E5%B8%B8%E8%A7%81%E9%97%AE%E9%A2%98 &ndash;&gt;
        <bean id="dataSourceQuartz" class="com.alibaba.druid.pool.DruidDataSource" init-method="init"
              destroy-method="close">
            &lt;!&ndash;创建MySQL UTF-8编码数据库脚本：CREATE DATABASE knight DEFAULT CHARACTER SET utf8 COLLATE utf8_general_ci;&ndash;&gt;
            <property name="url" value="${jdbc_url}"/>
            <property name="username" value="${jdbc_username}"/>
            <property name="password" value="${jdbc_password}"/>
        </bean>

        <import resource="classpath*:/service/spring*.xml"/>

    </beans>


    &lt;!&ndash;用于Unit Test配置&ndash;&gt;
    <beans profile="test">
        &lt;!&ndash;缺省PropertyPlaceholder定义&ndash;&gt;
        <bean id="extPropertyPlaceholderConfigurer" class="com.knight.core.context.ExtPropertyPlaceholderConfigurer">
            <property name="locations">
                <list>
                    <value>classpath:/application.properties</value>
                    &lt;!&ndash;<value>classpath:/application-test.properties</value>&ndash;&gt;
                </list>
            </property>
            <property name="ignoreResourceNotFound" value="true"/>
            <property name="systemPropertiesModeName" value="SYSTEM_PROPERTIES_MODE_OVERRIDE"/>
        </bean>

        &lt;!&ndash;嵌入式内存数据库&ndash;&gt;
        <bean id="dataSourceApp" class="com.alibaba.druid.pool.DruidDataSource" init-method="init"
              destroy-method="close">
            &lt;!&ndash;基本属性 url、user、password&ndash;&gt;
            <property name="url" value="jdbc:h2:mem:h2db-app"/>
            <property name="username" value="root"/>
            <property name="password" value=""/>

            &lt;!&ndash;配置监控统计拦截的filters, 去掉后监控界面sql无法统计&ndash;&gt;
            <property name="proxyFilters">
                <list>
                    <ref bean="log-filter"/>
                </list>
            </property>
        </bean>

        &lt;!&ndash;嵌入式内存数据库&ndash;&gt;
        <bean id="dataSourceAud" class="com.alibaba.druid.pool.DruidDataSource" init-method="init"
              destroy-method="close">
            &lt;!&ndash;基本属性 url、user、password&ndash;&gt;
            <property name="url" value="jdbc:h2:mem:h2db-app"/>
            <property name="username" value="root"/>
            <property name="password" value=""/>

            &lt;!&ndash;配置监控统计拦截的filters, 去掉后监控界面sql无法统计&ndash;&gt;
            <property name="proxyFilters">
                <list>
                    <ref bean="log-filter"/>
                </list>
            </property>
        </bean>

        &lt;!&ndash;嵌入式内存数据库&ndash;&gt;
        <bean id="dataSourceQuartz" class="com.alibaba.druid.pool.DruidDataSource" init-method="init"
              destroy-method="close">
            &lt;!&ndash;基本属性 url、user、password&ndash;&gt;
            <property name="url" value="jdbc:h2:mem:h2db-app"/>
            <property name="username" value="root"/>
            <property name="password" value=""/>

            &lt;!&ndash;配置监控统计拦截的filters, 去掉后监控界面sql无法统计&ndash;&gt;
            <property name="proxyFilters">
                <list>
                    <ref bean="log-filter"/>
                </list>
            </property>
        </bean>
    </beans>-->
</beans>